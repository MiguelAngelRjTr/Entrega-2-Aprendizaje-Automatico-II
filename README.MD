# Segmentaci√≥n de clientes con Clustering (PCA + KMeans + GMM)

Este proyecto implementa un flujo completo de **an√°lisis exploratorio (EDA)**, **preprocesado**, **reducci√≥n de dimensionalidad con PCA** y **modelos de clustering** para segmentar clientes a partir de variables de comportamiento financiero.

El objetivo principal es identificar grupos homog√©neos de clientes utilizando t√©cnicas no supervisadas, apoy√°ndose en m√©tricas cuantitativas y visualizaciones interpretables.

**Autor:** Miguel Angel Rojas Torres

---

## üìë √çndice

1. [Descripci√≥n del proyecto](#descripci√≥n-del-proyecto)  
2. [Estructura del repositorio](#estructura-del-repositorio)  
3. [Dataset](#dataset)  
4. [Metodolog√≠a](#metodolog√≠a)  
   - [EDA](#eda)  
   - [Preprocesado](#preprocesado)  
   - [Reducci√≥n de dimensionalidad (PCA)](#reducci√≥n-de-dimensionalidad-pca)  
   - [Clustering](#clustering)  
5. [Modelos implementados](#modelos-implementados)  
6. [Resultados principales](#resultados-principales)  
7. [Reproducibilidad](#reproducibilidad)  
8. [Ejecuci√≥n del proyecto](#ejecuci√≥n-del-proyecto)  
9. [Requisitos](#requisitos)  

---

## Descripci√≥n del proyecto

La segmentaci√≥n de clientes es un problema cl√°sico en anal√≠tica de negocio y marketing. En este trabajo se emplean algoritmos de clustering para descubrir patrones de comportamiento en clientes de tarjeta de cr√©dito.

El pipeline incluye:

- Tratamiento de valores faltantes
- Identificaci√≥n de ceros estructurales
- Transformaci√≥n logar√≠tmica para variables monetarias asim√©tricas
- Escalado de variables
- PCA para reducci√≥n dimensional
- Clustering con **KMeans** y modelo alternativo **Gaussian Mixture Model (GMM)**

---

## Estructura del repositorio

La organizaci√≥n del proyecto es la siguiente:

```
‚îú‚îÄ‚îÄ data/
‚îÇ ‚îî‚îÄ‚îÄ CC_GENERAL.csv # Dataset original
‚îÇ
‚îú‚îÄ‚îÄ figures/
‚îÇ ‚îú‚îÄ‚îÄ images/ # Imagenes importadas
‚îÇ ‚îî‚îÄ‚îÄ eda.html # Reporte autom√°tico generado con ydata-profiling
‚îÇ
‚îú‚îÄ‚îÄ notebooks/
‚îÇ ‚îî‚îÄ‚îÄ Rojas_Torres_MiguelAngel_assignment2.ipynb # Notebook principal del proyecto
‚îÇ
‚îú‚îÄ‚îÄ environment.yml # Entorno conda reproducible

```

---

## Dataset

El dataset utilizado (`CC_GENERAL.csv`) contiene informaci√≥n agregada del comportamiento de clientes con tarjeta de cr√©dito, incluyendo:

- Balance medio
- Compras totales y frecuencia
- Avances de efectivo
- Pagos realizados
- L√≠mite de cr√©dito
- Antig√ºedad del cliente (tenure)

Este tipo de variables presentan distribuciones altamente asim√©tricas, por lo que requieren transformaciones robustas antes de aplicar clustering.

---

## Metodolog√≠a

### EDA

En primer lugar se realiza un an√°lisis exploratorio para:

- Examinar distribuciones y escalas
- Detectar asimetr√≠as fuertes en variables monetarias
- Evaluar valores faltantes
- Identificar ceros estructurales relevantes

Se incluye un reporte autom√°tico generado con `ydata-profiling`:

- `figures/eda.html`

---

### Preprocesado

El preprocesado se implementa mediante `Pipeline` y `ColumnTransformer` de `scikit-learn`.

Incluye:

- Imputaci√≥n con mediana (`SimpleImputer(strategy="median")`)
- Transformaci√≥n logar√≠tmica `log(1+x)` en variables monetarias
- Escalado con `StandardScaler`

Este enfoque permite garantizar consistencia y reproducibilidad dentro de un pipeline completo.

---

### Reducci√≥n de dimensionalidad (PCA)

Dado que el dataset contiene m√∫ltiples variables correlacionadas, se aplica PCA para:

- Reducir redundancia
- Mejorar eficiencia del clustering
- Facilitar visualizaci√≥n en 2D

Se selecciona un PCA reducido reteniendo el **95% de varianza explicada**, lo que reduce el espacio a aproximadamente 12 componentes.

---

### Clustering

Se exploran modelos no supervisados mediante:

- M√©todo del codo (inercia)
- Silhouette score
- BIC (para GMM)

Adem√°s se incluyen visualizaciones:

- Proyecci√≥n PCA 2D
- Proyecci√≥n t-SNE
- Tama√±o relativo de clusters
- Perfil medio de variables por segmento

---

## Modelos implementados

### KMeans

Modelo principal basado en particiones, evaluado para distintos valores de *k*.

Selecci√≥n final basada en:

- Punto de inflexi√≥n en inercia
- Silhouette score
- Interpretabilidad de segmentos

---

### Gaussian Mixture Model (GMM)

Modelo alternativo basado en clustering probabil√≠stico.

Evaluaci√≥n mediante:

- Silhouette score
- Bayesian Information Criterion (BIC)

Se selecciona un modelo con **k = 3** componentes como alternativa compacta.

---

## Resultados principales

Los clusters obtenidos permiten distinguir perfiles diferenciados, por ejemplo:

- Clientes con alta actividad de compras
- Clientes de perfil moderado y uso controlado
- Clientes con bajo consumo y pagos m√≠nimos

El an√°lisis incluye:

- Distribuci√≥n de tama√±os de clusters
- Interpretaci√≥n mediante medias por grupo
- Comparaci√≥n entre KMeans y GMM

---

## Reproducibilidad

El proyecto incluye un entorno conda exportado, `environment.yml`. Para recrearlo:

```bash
conda env create -f environment.yml
conda activate ml-core
```

---

## Ejecuci√≥n del proyecto

1. Clonar repositorio:

```bash
git clone https://github.com/MiguelAngelRjTr/Entrega-2-Aprendizaje-Automatico-II.git
```

2. Crear entorno:

```bash
conda env create -f environment.yml
conda activate ml-core
```

3. Ejecutar notebook principal

---

## Requisitos

El proyecto utiliza principalmente:

- Python ‚â• 3.10
- numpy
- pandas
- scikit-learn
- matplotlib
- seaborn
- ydata-profiling
- joblib

Todas las dependencias del entorno est√°n recogidas en `environment.yml`.